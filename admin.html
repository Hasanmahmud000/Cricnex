<!DOCTYPE html>
<html>
<head>
  <title>Admin Panel - BDStreamHub</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: sans-serif; background: #111; color: #fff; padding: 20px; }
    input, button { padding: 8px; margin: 5px 0; width: 100%; }
    table { width: 100%; margin-top: 20px; border-collapse: collapse; }
    th, td { border: 1px solid #444; padding: 8px; text-align: left; }
    button { background: #28a745; color: #fff; border: none; cursor: pointer; }
    button.delete { background: #dc3545; }
    button.edit { background: #ffc107; color: #000; }
  </style>
</head>
<body>

<h2>üéÆ BDStreamHub Admin Panel</h2>

<input id="match_name" placeholder="Match Name">
<input id="stream_url" placeholder="Stream URL (.m3u8)">
<input id="start_time" placeholder="Start Time (YYYY-MM-DD HH:MM:SS)">
<input id="countdown_time" placeholder="Countdown Time (YYYY-MM-DDTHH:MM:SSZ)">
<button onclick="addMatch()">‚ûï Add Match</button>

<h3>üìã Existing Matches</h3>
<table>
  <thead>
    <tr><th>Match</th><th>URL</th><th>Start</th><th>Countdown</th><th>Action</th></tr>
  </thead>
  <tbody id="matchTable"></tbody>
</table>

<script>
  const scriptURL = 'https://script.google.com/macros/s/AKfycbxEhiRYIXhCaUegke__Gj9e64uZwaWNTDEEffAnkqc5Oh7A9RWdATMhgKSPOGxlM3FzdQ/exec'; // Replace this with your deployed Apps Script URL

  async function fetchMatches() {
    const res = await fetch(scriptURL);
    const data = await res.json();
    const table = document.getElementById('matchTable');
    table.innerHTML = '';

    data.forEach((row, index) => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${row.match_name}</td>
        <td>${row.stream_url}</td>
        <td>${row.start_time}</td>
        <td>${row.countdown_time}</td>
        <td>
          <button class="edit" onclick="editMatch(${index})">‚úèÔ∏è Edit</button>
          <button class="delete" onclick="deleteMatch(${index})">üóëÔ∏è Delete</button>
        </td>`;
      table.appendChild(tr);
    });
  }

  async function addMatch() {
    const body = {
      match_name: document.getElementById('match_name').value,
      stream_url: document.getElementById('stream_url').value,
      start_time: document.getElementById('start_time').value,
      countdown_time: document.getElementById('countdown_time').value,
      action: "add"
    };
    await fetch(scriptURL, {
      method: "POST",
      body: JSON.stringify(body)
    });
    fetchMatches();
  }

  async function deleteMatch(index) {
    await fetch(scriptURL, {
      method: "POST",
      body: JSON.stringify({ action: "delete", index })
    });
    fetchMatches();
  }

  async function editMatch(index) {
    const match_name = prompt("New Match Name:");
    const stream_url = prompt("New Stream URL:");
    const start_time = prompt("New Start Time:");
    const countdown_time = prompt("New Countdown Time:");

    await fetch(scriptURL, {
      method: "POST",
      body: JSON.stringify({
        action: "edit",
        index,
        match_name,
        stream_url,
        start_time,
        countdown_time
      })
    });
    fetchMatches();
  }

  fetchMatches();
</script>
</body>
</html>
